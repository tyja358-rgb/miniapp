<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>KWT Mini App ⚡ Кабинет</title>
  <script src="https://cdn.adsonar.io/ad.js"></script>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      text-align: center; 
      margin: 30px; 
      background: #f0f8ff; 
    }
    h2 { color: #333; }
    button {
      background-color: #4CAF50; 
      color: white; 
      font-size: 16px;
      padding: 10px 25px; 
      border-radius: 8px; 
      cursor: pointer; 
      margin: 10px;
      transition: transform 0.1s, box-shadow 0.2s;
    }
    button:active { transform: scale(1.05); box-shadow: 0 0 15px #4CAF50; }
    
    .bar-container {
      width: 80%; height: 25px; background-color: #ccc; margin: 10px auto;
      border-radius: 12px; overflow: hidden; box-shadow: inset 0 0 5px #0003;
    }
    .bar-fill {
      height: 100%; width: 0%; background: linear-gradient(to right, #4CAF50, #00FFAA);
      transition: width 0.5s;
    }

    #bonus { font-size: 16px; color: #ff4500; margin-top: 10px; }
    #spark { font-size: 24px; display: inline-block; margin-left: 10px; animation: spark 0.5s ease-out; }
    @keyframes spark { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.5); opacity: 1; } 100% { transform: scale(1); opacity: 0; } }
  </style>
</head>
<body>
  <h2>Добро пожаловать в KWT Mini App ⚡</h2>
  <p>Кабинет пользователя: <span id="user-id">User123</span></p>

  <h3>Энергия за рекламу (для апгрейдов)</h3>
  <div class="bar-container">
    <div id="ad-energy-fill" class="bar-fill"></div>
  </div>
  <p>Баланс рекламной энергии: <span id="ad-energy">0</span></p>
  <button id="watch-ad">Смотреть рекламу и получить энергию</button>
  <button id="upgrade-station">Прокачать электростанцию (-5 энергии)</button>

  <h3>Денежная шкала (можно вывести в TON)</h3>
  <div class="bar-container">
    <div id="money-fill" class="bar-fill"></div>
  </div>
  <p>Баланс денег: <span id="money">0.00</span> KWT</p>
  <button id="withdraw-money">Вывести в TON</button>

  <p id="bonus"></p>

  <script>
    // Тестовые данные пользователя (в будущем подключение через Telegram)
    let userId = "User123"; 
    document.getElementById("user-id").innerText = userId;

    // Балансы
    let adEnergy = parseFloat(localStorage.getItem(userId+"_adEnergy")) || 0;
    let money = parseFloat(localStorage.getItem(userId+"_money")) || 0;

    function updateBars() {
      document.getElementById("ad-energy").innerText = adEnergy.toFixed(2);
      document.getElementById("money").innerText = money.toFixed(2);

      // Прогресс бары (макс 20 для рекламы, макс 100 для денег для примера)
      document.getElementById("ad-energy-fill").style.width = Math.min(adEnergy/20*100,100)+"%";
      document.getElementById("money-fill").style.width = Math.min(money/100*100,100)+"%";
    }

    function watchAd() {
      let gain = 1; // энергия за просмотр
      adEnergy += gain;
      localStorage.setItem(userId+"_adEnergy", adEnergy);
      updateBars();
      alert(`Вы получили ${gain} рекламной энергии!`);
    }

    function upgradeStation() {
      if(adEnergy >= 5) {
        adEnergy -= 5;
        localStorage.setItem(userId+"_adEnergy", adEnergy);
        updateBars();
        alert("Электростанция улучшена!"); // Позже сюда можно добавить визуальные апгрейды
      } else {
        alert("Недостаточно рекламной энергии для апгрейда!");
      }
    }

    function withdrawMoney() {
      if(money > 0) {
        let amount = money.toFixed(2);
        money = 0;
        localStorage.setItem(userId+"_money", money);
        updateBars();
        alert(`Вы вывели ${amount} KWT в TON через Telegram!`);
      } else {
        alert("Баланс пустой!");
      }
    }

    document.getElementById("watch-ad").addEventListener("click", watchAd);
    document.getElementById("upgrade-station").addEventListener("click", upgradeStation);
    document.getElementById("withdraw-money").addEventListener("click", withdrawMoney);

    // Инициализация при загрузке
    updateBars();
  </script>
</body>
</html>
